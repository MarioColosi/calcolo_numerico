	PROGRAM WINKINSON
	PARAMETER(MAX_N=100)
	INTEGER MATRIX(MAX_N,MAX_N)
	REAL T1,T2
	WRITE(*,*)'Inserisci il numero di righe e di colonne:'
	READ(*,*)N
	
	T1=SECNDS(0.0)
	DO I=1,100000
      CALL INIT_MATRIX(MATRIX,MAX_N,N)
	END DO
	T2=SECNDS(T1)

DO I=1,N
WRITE(*,*)(MATRIX(I,J),J=1,N)
WRITE(*,*)
END DO

	WRITE(*,*)'Secondi:',T2
	READ(*,*)N
	END

	SUBROUTINE INIT_MATRIX(MATRIX,MAX_N,N)
	INTEGER MATRIX(MAX_N,N)
	INTEGER X
	LOGICAL VAL
	MATRIX(1,1)=1
	DO J=2,N-2
		MATRIX(1,J)=0
	END DO
	MATRIX(1,J)=0
	MATRIX(1,J+1)=-1
	VAL=.FALSE.
	DO I=2,N-1
		IF(VAL)THEN
			MATRIX(I,N)=-1
			X=-1
		ELSE
			MATRIX(I,N)=1
			X=1
		END IF
		DO J=1,I-2
			MATRIX(I,J)=X
			X=-X
		END DO	  
		MATRIX(I,J)=X
		MATRIX(I,I)=1
		DO J=I+1,N-1
			MATRIX(I,J)=0
		END DO
		VAL=.NOT.VAL
	END DO 
	IF(VAL)THEN
		MATRIX(I,N)=-1
		X=-1
	ELSE
		MATRIX(I,N)=1
		X=1
	END IF
	DO J=1,I-2
		MATRIX(I,J)=X
		X=-X
	END DO	  
	MATRIX(I,J)=X
	MATRIX(I,I)=1
	END

